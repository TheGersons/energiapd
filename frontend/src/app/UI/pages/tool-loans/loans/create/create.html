<div class="space-y-5">
  <div class="w-full flex justify-between items-center">
    <div>
      <div class="flex items-center gap-2">
        <button
          (click)="goBack()"
          class="p-0 rounded-full h-6 w-6 hover:bg-gray-200 rounded-full cursor-pointer">
          <app-loader [name]="'arrow-left'" hostClass="w-6 h-6"></app-loader>
        </button>
        <h2 class="text-2xl font-bold">Solicitud de Préstamo</h2>
      </div>
      <h3 class="text-gray-500">Gestión de Usuarios</h3>
    </div>
  </div>
  <div class="space-y-4">
    <form
      novalidate
      autocomplete="off"
      (submit)="onCreate($event)"
      class="p-4 rounded-md shadow-md border border-blue-200 bg-white grid grid-cols-1 gap-4">
      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="name">Nombre del solicitante:</label>
        <input
          [formField]="loanForm.loanName"
          id="name"
          type="text"
          placeholder="Nombre del solicitante"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500" />
        @if (isFieldInvalid("loanName")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of loanForm.loanName().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>

      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="dni"
          >Identidad del solicitante:</label
        >

        <input
          [formField]="loanForm.loanDni"
          id="dni"
          type="text"
          placeholder="Ej: XXXX-XXXX-XXXXX"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500" />

        @if (isFieldInvalid("loanDni")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of loanForm.loanDni().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>

      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="department">Departamento:</label>

        <input
          [formField]="loanForm.loanDepartment"
          id="department"
          type="text"
          placeholder="Departamento al que pertenece"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500" />

        @if (isFieldInvalid("loanDepartment")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of loanForm.loanDepartment().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>

      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="useDescription"
          >Descripción de Uso:</label
        >

        <input
          [formField]="loanForm.loanUseDescription"
          id="useDescription"
          type="text"
          placeholder="¿Para qué se usarán las herramientas?"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500" />

        @if (isFieldInvalid("loanUseDescription")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of loanForm.loanUseDescription().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>

      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="returnDate"
          >Retorno de Herramientas:</label
        >

        <input
          [formField]="loanForm.loanReturnDate"
          id="returnDate"
          type="datetime-local"
          placeholder="Cuando retornará las herramientas"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500" />

        @if (isFieldInvalid("loanReturnDate")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of loanForm.loanReturnDate().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>

      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="loanNotes">Observaciones:</label>

        <input
          [formField]="loanForm.loanNotes"
          id="loanNotes"
          type="text"
          placeholder="Cualquier comentario u observación"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500" />

        @if (isFieldInvalid("loanNotes")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of loanForm.loanNotes().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>

      <div
        class="overflow-x-auto rounded-xl shadow-sm border border-dashed border-blue-200 bg-white">
        <div class="px-3 py-2">
          <div
            class="flex *:border *:border-gray-200 *:bg-neutral-100 *:cursor-pointer *:disabled:cursor-not-allowed *:disabled:opacity-50 inline-flex rounded-md *:first:rounded-s-md *:last:rounded-e-md overflow-hidden">
            <button (click)="toggleModal.set(true)" type="button" class="p-1">
              <app-loader name="create" hostClass="h-6 w-6"></app-loader>
            </button>
            <button class="p-1">
              <app-loader name="delete" hostClass="h-6 w-6"></app-loader>
            </button>
            <button class="p-1">
              <app-loader hostClass="h-6 w-6" name="edit"></app-loader>
            </button>
          </div>
        </div>
        <table
          class="min-w-full border-collapse text-left text-sm text-gray-700">
          <thead class="bg-neutral-100 sticky z-10">
            <tr class="*:px-6 *:py-3 *:font-semibold">
              <th>Nombre</th>
              <th>Marca</th>
              <th>Modelo</th>
            </tr>
          </thead>
          <tbody
            class="divide-y divide-gray-200 [&_td]:px-6 [&_td]:py-3 [&_tr]:hover:bg-blue-50 cursor-pointer">
            <tr>
              <td>
                <div class="flex gap-2 items-center">
                  <app-loader name="img" hostClass="h-3 w-3"></app-loader>
                  Megger
                </div>
              </td>
              <td>Megger</td>
              <td>Megger</td>
            </tr>
            <tr>
              <td>
                <div class="flex gap-2 items-center">
                  <app-loader name="img" hostClass="h-3 w-3"></app-loader>
                  Megger
                </div>
              </td>
              <td>Megger</td>
              <td>Megger</td>
            </tr>
            <tr>
              <td>
                <div class="flex gap-4 items-center">
                  <div class="rounded-md overflow-hidden shadow-md">
                    <img
                      src="https://nx88862.your-storageshare.de/apps/files_sharing/publicpreview/qPRcbAdTjmQY7QZ?file=/&fileId=109281"
                      class="object-cover" />
                  </div>
                  Megger
                </div>
              </td>
              <td>Megger</td>
              <td>Megger</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div
        class="flex items-center justify-end border-t border-gray-300 p-4 space-x-5">
        <button
          type="button"
          class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-400">
          Cancelar
        </button>
        <button
          type="submit"
          class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-500">
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>

<div
  (click)="toggleModal.set(false)"
  [class.hidden]="!toggleModal()"
  class="modal fixed inset-0 z-50 w-full overflow-hidden bg-gray-800/75 flex justify-center items-center transition-all">
  <div
    (click)="$event.stopPropagation()"
    class="flex flex-col rounded-lg shadow-lg max-w-[85%] max-h-[95%] min-h-[75%] w-full relative overflow-y-auto overflow-hidden">
    <!-- Modal Content -->
    <div class="relative bg-white rounded-lg shadow-sm flex-1">
      <!-- Modal Header -->
      <div
        class="flex items-center justify-between p-4 border-b rounded-t border-none">
        <h3 class="text-3xl font-semibold">Nuevo Equipo</h3>
        <button
          (click)="toggleModal.set(false)"
          type="button"
          class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center focus:outline-none focus:bg-gray-100">
          <svg
            class="w-3 h-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 14 14">
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
          </svg>
          <span class="sr-only">Close modal</span>
        </button>
      </div>
      <!-- Modal Body -->
      <div class="flex flex-col gap-6 p-4">
        <input
          type="search"
          class="w-1/2 rounded-md border border-blue-200 px-2 py-1 hover:bg-gray-100 focus:bg-gray-200 focus:outline-0"
          placeholder="Busqueda de herramientas..." />
        <div class="grid grid-cols-4 gap-6">
          @for (a of toolResource.value(); track $index) {
            <div
              class="flex gap-4 rounded-md overflow-hidden shadow-md border border-dashed border-blue-200">
              <img [src]="a.toolImg" alt="" />
              <div class="flex flex-col text-gray-600">
                <span>{{ a.toolName }}</span>
                <span>{{ a.toolModel }}</span>
                <span>{{ a.toolBrand }}</span>
              </div>
            </div>
          }
        </div>
      </div>
      <!-- Modal footer -->
      <div
        class="flex items-center p-4 md:p-5 space-x-3 rtl:space-x-reverse rounded-b dark:border-gray-600">
        <button
          type="button"
          class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
          Guardar
        </button>
        <button
          type="button"
          class="py-2.5 px-5 ms-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          Cancelar
        </button>
      </div>
    </div>
  </div>
  <!-- fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full -->
</div>
