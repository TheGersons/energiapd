<div class="space-y-5">
  <div class="w-full flex justify-between items-center">
    <div>
      <div class="flex items-center gap-2">
        <button
          (click)="goBack()"
          class="p-0 rounded-full h-6 w-6 hover:bg-gray-200 rounded-full cursor-pointer">
          <app-loader [name]="'arrow-left'" hostClass="w-6 h-6"></app-loader>
        </button>
        <h2 class="text-2xl font-bold">
          Creación o Modificación de Rol y Permisos
        </h2>
      </div>
      <h3 class="text-gray-500">Gestión de Usuarios</h3>
    </div>
  </div>
  <div class="space-y-4">
    <form
      novalidate
      autocomplete="off"
      (submit)="onSubmit($event)"
      class="p-4 rounded-md shadow-md border border-blue-200 bg-white grid grid-cols-1 gap-4">
      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="userFullName">Nombre:</label>
        <input
          [formField]="userForm.displayName"
          type="text"
          id="userFullName"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500"
          placeholder="Nombre del Usuario" />
        @if (isFieldInvalid("displayName")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of userForm.displayName().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>
      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="username">Usuario:</label>
        <input
          [formField]="userForm.username"
          type="text"
          id="username"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500"
          placeholder="Ej: apodo123" />
        @if (isFieldInvalid("username")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of userForm.username().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>
      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="userMail">Correo Electrónico:</label>
        <input
          [formField]="userForm.userMail"
          type="email"
          id="userMail"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500"
          placeholder="Ej: usuario@example.com" />
        @if (isFieldInvalid("userMail")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of userForm.userMail().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>
      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="userPass">Contraseña:</label>
        <div class="flex gap-2">
          <div class="w-full relative">
            <input
              [formField]="userForm.userPass"
              [type]="showPassword() ? 'text' : 'password'"
              id="userPass"
              class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500 placeholder:text-gray-500"
              placeholder="Contraseña" />
            <button
              type="button"
              (click)="showPassword.set(!showPassword())"
              class="absolute inset-y-0 right-2 flex items-center">
              <app-loader
                [name]="!showPassword() ? 'eye' : 'eye-slash'"
                [hostClass]="'w-5 h-5 text-gray-500 hover:text-gray-700'">
              </app-loader>
            </button>
          </div>
          <button
            (click)="generatePassword()"
            type="button"
            class="cursor-pointer px-2 py-1 text-gray-800 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors">
            <app-loader
              name="generate-pass"
              [hostClass]="'h-6 w-6'"></app-loader>
          </button>
        </div>
        @if (isFieldInvalid("userPass")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of userForm.userPass().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <ul>
                {{
                  a.message
                }}
              </ul>
            }
          </p>
        }
      </div>
      <div class="flex gap-2">
        <input
          [formField]="userForm.needChangePass"
          type="checkbox"
          id="requestChangePass" />
        <label for="requestChangePass">Solicitar cambio de contraseña</label>
      </div>
      <div class="flex flex-col space-y-2">
        <label class="font-semibold" for="userRoleId">Rol:</label>
        <ng-select
          [formField]="userForm.userRoles"
          [attr.autocomplete]="'off'"
          multiple="true"
          placeholder="Seleccione el Rol">
          @for (a of rolesResource.value(); track $index) {
            <ng-option [value]="a">{{ a.roleName }}</ng-option>
          }
        </ng-select>
        @if (isFieldInvalid("userRoles")) {
          <p class="text-sm text-red-400 font-medium flex items-center gap-1">
            @for (a of userForm.userRoles().errors(); track $index) {
              <app-loader
                name="warning"
                hostClass="w-3 h-3 text-red-400"></app-loader>
              <span>{{ a.message }}</span>
            }
          </p>
        }
      </div>
      <div
        class="flex items-center justify-end border-t border-gray-300 p-4 space-x-5">
        <button
          type="submit"
          class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-400">
          Cancelar
        </button>
        <button
          class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-500">
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>
